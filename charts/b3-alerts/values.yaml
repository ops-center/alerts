metadata:
  resource:
    group: alerts.appscode.com
    kind: B3Alerts
    name: b3alerts
    scope: Namespaced
    version: v1alpha2
  release:
    name: ""
    namespace: ""

form:
  alert:
    enabled: warning
    labels: # +doc-gen:break
      release: kube-prometheus-stack
    annotations: {}
    additionalRuleLabels: {}

    groups:
      process:
        enabled: warning
        rules:
          b3ProcessRestarted:
            enabled: true
            duration: "0m"
            severity: warning
          b3HighGoroutineCount:
            enabled: true
            duration: "10m"
            severity: warning
            val: 10000
          b3HighGcPauseDuration:
            enabled: true
            duration: "5m"
            severity: warning
            val: 0.2
          b3HighFileDescriptorUsage:
            enabled: true
            duration: "5m"
            severity: warning
            val: 80
          # val: bytes/sec (291 ≈ 1MB/hour)
          b3MemoryLeak:
            enabled: true
            duration: "2h"
            severity: warning
            val: 291
          # val: cores/sec (0.0001 ≈ 0.36 cores/hour)
          b3CpuRunaway:
            enabled: true
            duration: "2h"
            severity: warning
            val: 0.0001
          # val: goroutines/sec (0.1 ≈ 360/hour)
          b3GoroutineLeak:
            enabled: true
            duration: "2h"
            severity: warning
            val: 0.1

      http:
        enabled: warning
        rules:
          b3HighHttpErrorRate:
            enabled: true
            duration: "5m"
            severity: critical
            val: 5
          b3HighHttpLatency:
            enabled: true
            duration: "5m"
            severity: warning
            val: 1
          b3HighActiveRequests:
            enabled: true
            duration: "5m"
            severity: warning
            val: 1000

      database:
        enabled: warning
        rules:
          b3HighDatabaseErrorRate:
            enabled: true
            duration: "5m"
            severity: critical
            val: 5
          b3HighDatabaseLatency:
            enabled: true
            duration: "5m"
            severity: warning
            val: 0.5
          b3DatabaseConnectionErrors:
            enabled: true
            duration: "5m"
            severity: critical
            val: 5
          b3HighDatabaseConnectionPoolUsage:
            enabled: true
            duration: "5m"
            severity: warning
            val: 80

      auth:
        enabled: warning
        rules:
          b3HighAuthFailureRate:
            enabled: true
            duration: "5m"
            severity: warning
            val: 10

      storage:
        enabled: warning
        rules:
          b3HighBlobStorageErrorRate:
            enabled: true
            duration: "5m"
            severity: warning
            val: 5

      proxy:
        enabled: warning
        rules:
          b3HighProxyErrorRate:
            enabled: true
            duration: "5m"
            severity: warning
            val: 5
          b3HighProxyLatency:
            enabled: true
            duration: "5m"
            severity: warning
            val: 5

grafana:
  enabled: false
  version: 8.2.3
  jobName: ace-platform-api
  url: ""
  apikey: ""
